# Detect HTTP requests with .php? parameter
alert http any any -> any any (msg:"Suspicious PHP Query Detected"; flow:to_server,established; uricontent:".php?"; nocase; sid:2000021; rev:1;)

# Detect attempt to access /etc/passwd
alert http any any -> any any (msg:"Access to /etc/passwd Attempt"; flow:to_server,established; uricontent:"/etc/passwd"; nocase; sid:2000022; rev:1;)

# Detect MS-SQL connection attempt
alert tcp any any -> any 1433 (msg:"MSSQL Connection Attempt Detected"; flow:to_server,established; sid:2000023; rev:1;)

# Detect SMB connection (port 445)
alert tcp any any -> any 445 (msg:"SMB Connection Attempt"; flow:to_server,established; sid:2000024; rev:1;)

# Detect HTTP requests containing "cmd.exe"
alert http any any -> any any (msg:"Attempt to Invoke cmd.exe via HTTP"; flow:to_server,established; content:"cmd.exe"; nocase; sid:2000025; rev:1;)

# Detect unusual SSH banner
alert tcp any any -> any 22 (msg:"Unusual SSH Banner Detected"; flow:from_server,established; content:"OpenSSH_2.0"; sid:2000026; rev:1;)

# Detect access to hidden files (e.g., .git)
alert http any any -> any any (msg:"Access to Hidden .git Folder"; uricontent:"/.git"; nocase; sid:2000027; rev:1;)

# Detect login page brute-force attempt (many POSTs)
alert http any any -> any any (msg:"Possible HTTP Brute Force (Multiple POSTs)"; flow:to_server,established; http.method; content:"POST"; threshold:type threshold,track by_src,count 10,seconds 30; sid:2000028; rev:1;)

# Detect suspicious user agent for Metasploit
alert http any any -> any any (msg:"Metasploit User-Agent Detected"; content:"Mozilla/4.0 (compatible\; MSIE 6.0\; Windows NT 5.1)"; http_header; nocase; sid:2000029; rev:1;)

# Detect reverse shell via HTTP
alert http any any -> any any (msg:"HTTP Reverse Shell Pattern Detected"; content:"/bin/sh"; http_client_body; nocase; sid:2000030; rev:1;)

# Detect HTTP requests with base64 encoded strings
alert http any any -> any any (msg:"Suspicious Base64 Encoded String in URI"; uricontent:"%3D"; nocase; sid:2000031; rev:1;)

# Detect mass SMTP sending
alert tcp any any -> any 25 (msg:"Mass SMTP Sending Detected"; flow:to_server,established; threshold:type threshold,track by_src,count 50,seconds 60; sid:2000032; rev:1;)

# Detect SQL Dump attempt
alert http any any -> any any (msg:"SQL Dump Attempt Detected"; flow:to_server,established; content:"SELECT * FROM"; nocase; http_client_body; sid:2000033; rev:1;)

# Detect HTTP 500 Internal Server Error responses
alert http any any -> any any (msg:"HTTP 500 Error Response Detected"; flow:from_server,established; content:"500 Internal Server Error"; http_stat_code; sid:2000034; rev:1;)

# Detect JavaScript Injection attempt
alert http any any -> any any (msg:"JavaScript Injection Attempt Detected"; content:"<script>"; nocase; http_client_body; sid:2000035; rev:1;)

# Detect DNS tunneling
alert dns any any -> any any (msg:"Possible DNS Tunneling Detected"; dns.query; pcre:"/^[A-Za-z0-9]{30,}\./"; sid:2000036; rev:1;)

# Detect VPN traffic to suspicious country
alert ip any any -> any any (msg:"VPN Traffic to Suspicious Country Detected"; ip_proto:47; sid:2000037; rev:1;)

# Detect IoT Device Communication (e.g., Mirai Botnet signatures)
alert tcp any any -> any any (msg:"Possible IoT Botnet Communication (Mirai Pattern)"; content:"/shell"; nocase; sid:2000038; rev:1;)

# Detect file inclusion attempts
alert http any any -> any any (msg:"Remote File Inclusion Attempt"; flow:to_server,established; uricontent:"http://"; nocase; sid:2000039; rev:1;)

# Detect PING flood attack
alert icmp any any -> any any (msg:"Possible ICMP Flood Attack"; itype:8; threshold:type threshold,track by_src,count 100,seconds 10; sid:2000040; rev:1;)
